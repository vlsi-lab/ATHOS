#include <stdio.h>
#include <inttypes.h>
#include <string.h>

#include "core_v_mini_mcu.h"
#include "athos_ip_x_heep.h"
#include "athos_ip_driver.h"
#include "keccak_ip_driver.h"
#include "init_athos_ip.h"
#include "csr.h"
#include "rv_plic.h"
#include "rv_plic_regs.h"
#include "rv_plic_structs.h"
#include "hart.h"

#define SIZE 50
#define ROL(a, offset) (((a) << (offset)) ^ ((a) >> (64 - (offset))))
#define OPERATION 1
#define NROUNDS 24

typedef struct {
    int16_t coeffs[256];
} poly;



int main(){

	static uint32_t Din[SIZE] __attribute__ ((aligned (4)));
	static uint32_t Dout[SIZE] __attribute__ ((aligned (4)));

	static uint32_t D_expected[SIZE];
	int i = 0;
	uint64_t s[25], s_exp[25];

	memset(Din, 0, sizeof(Din));
	memset(Dout, 0, sizeof(Dout));
	memset(D_expected, 0, sizeof(D_expected));
	
	unsigned int cycles = 0;

    poly r;
    int16_t golden_res[256];
    int16_t output[256];
    int16_t dout[256];
    int16_t golden_res_final[256];
    int16_t error = 0;

    size_t size = 256;

	Din[0] = 0x7369C667;
	Din[1] = 0xEC4AFF51;
	Din[2] = 0xABBACD29;
	Din[3] = 0x00000010;
	Din[31] = 0x80000000;

	s[0]  = 0xEC4AFF517369C667;
	s[1]  = 0x00000010ABBACD29;
    s[2]  = 0x0000000000000000;
    s[3]  = 0x0000000000000000;
    s[4]  = 0x0000000000000000;
    s[5]  = 0x0000000000000000;
    s[6]  = 0x0000000000000000;
    s[7]  = 0x0000000000000000;
    s[8]  = 0x0000000000000000;
    s[9]  = 0x0000000000000000;
    s[10] = 0x0000000000000000;
    s[11] = 0x0000000000000000;
    s[12] = 0x0000000000000000;
    s[13] = 0x0000000000000000;
    s[14] = 0x0000000000000000;
    s[15] = 0x8000000000000000;
    s[16] = 0x0000000000000000;
    s[17] = 0x0000000000000000;
    s[18] = 0x0000000000000000;
    s[19] = 0x0000000000000000;
    s[20] = 0x0000000000000000;
    s[21] = 0x0000000000000000;
    s[22] = 0x0000000000000000;
    s[23] = 0x0000000000000000;
    s[24] = 0x0000000000000000;

	

	D_expected[1] = 0xE1ADB0E2;
	D_expected[0] = 0xE7CB8356;
	D_expected[3] = 0xBB3F5FB8;
	D_expected[2] = 0x573A5BD7;
	D_expected[5] = 0xF7CA02A1;
	D_expected[4] = 0xE9784CC5;
	D_expected[7] = 0x6E54F256;
	D_expected[6] = 0x60A4C685;
	D_expected[9] = 0x77051F83;
	D_expected[8] = 0x243FCBAA;
	D_expected[11] = 0x6459DB0B;
	D_expected[10] = 0x4C063DD5;
	D_expected[13] = 0xE046DE71;
	D_expected[12] = 0xCB4B81C6;
	D_expected[15] = 0x94051793;
	D_expected[14] = 0xDB31F24C;
	D_expected[17] = 0xA13FC86C;
	D_expected[16] = 0xF16E32DD;
	D_expected[19] = 0xB962FC91;
	D_expected[18] = 0xB7737708;
	D_expected[21] = 0xD3CA2E7A;
	D_expected[20] = 0xFA27C801;
	D_expected[23] = 0x53C85108;
	D_expected[22] = 0xF72A3CCA;
	D_expected[25] = 0x73E732CD;
	D_expected[24] = 0xADF0E783;
	D_expected[27] = 0x8470BD54;
	D_expected[26] = 0xC4BDD1BF; 
	D_expected[29] = 0xD10B916F;
	D_expected[28] = 0x7C8C1F77; 
	D_expected[31] = 0x51129474;
	D_expected[30] = 0x440A2670; 
	D_expected[33] = 0x3D77CB49;
	D_expected[32] = 0xE9960C44; 
	D_expected[35] = 0xEC5001EB;
	D_expected[34] = 0xE4251E39; 
	D_expected[37] = 0x77A0EEC5;
	D_expected[36] = 0xEA4FD653;
	D_expected[39] = 0xEBC86BD4;
	D_expected[38] = 0x7B6773E7; 
	D_expected[41] = 0xE77DF6B0;
	D_expected[40] = 0x128FDC4B; 
	D_expected[43] = 0x0DB0D48A;
	D_expected[42] = 0x02F1B12E; 
	D_expected[45] = 0x241B344D;
	D_expected[44] = 0x0DC38AE5;
	D_expected[47] = 0xC3EE4E27;
	D_expected[46] = 0x532483D8;
	D_expected[49] = 0x0271BFE2;
	D_expected[48] = 0x84B1B424;

    s_exp[0] = 0xE1ADB0E2E7CB8356;
    s_exp[1] = 0xBB3F5FB8573A5BD7;
    s_exp[2] = 0xF7CA02A1E9784CC5;
    s_exp[3] = 0x6E54F25660A4C685;
    s_exp[4] = 0x77051F83243FCBAA;
    s_exp[5] = 0x6459DB0B4C063DD5;
    s_exp[6] = 0xE046DE71CB4B81C6;
    s_exp[7] = 0x94051793DB31F24C;
    s_exp[8] = 0xA13FC86CF16E32DD;
    s_exp[9] = 0xB962FC91B7737708;
    s_exp[10] = 0xD3CA2E7AFA27C801;
    s_exp[11] = 0x53C85108F72A3CCA;
    s_exp[12] = 0x73E732CDADF0E783;
    s_exp[13] = 0x8470BD54C4BDD1BF;
    s_exp[14] = 0xD10B916F7C8C1F77;
    s_exp[15] = 0x51129474440A2670;
    s_exp[16] = 0x3D77CB49E9960C44;
    s_exp[17] = 0xEC5001EBE4251E39;
    s_exp[18] = 0x77A0EEC5EA4FD653;
    s_exp[19] = 0xEBC86BD47B6773E7;
    s_exp[20] = 0xE77DF6B0128FDC4B;
    s_exp[21] = 0x0DB0D48A02F1B12E;
    s_exp[22] = 0x241B344D0DC38AE5;
    s_exp[23] = 0xC3EE4E27532483D8;
    s_exp[24] = 0x0271BFE284B1B424;


    printf("Hello Keccak\n");
    init_athos();
    CSR_CLEAR_BITS(CSR_REG_MCOUNTINHIBIT, 0x1);
    CSR_WRITE(CSR_REG_MCYCLE, 0);
	keccak_ip_driver(Din,Dout);
	CSR_READ(CSR_REG_MCYCLE, &cycles);
    printf("with %d cycles\n", cycles); 

	for (i = 0; i< SIZE; i++ ){
		if (Dout[i] != D_expected[i]){
			printf("ERROR keccak output did not match test vector. ");
        	printf("Expected D[%d]: %04X but obtained %04X \n", i, D_expected[i], Dout[i]);
		}	
	}	
	printf("Keccak terminated!\n");


    r.coeffs[0] = 0x1;
    r.coeffs[1] = 0xffff;
    r.coeffs[2] = 0xfffe;
    r.coeffs[3] = 0x1;
    r.coeffs[4] = 0xffff;
    r.coeffs[5] = 0x0;
    r.coeffs[6] = 0x0;
    r.coeffs[7] = 0x1;
    r.coeffs[8] = 0x0;
    r.coeffs[9] = 0x3;
    r.coeffs[10] = 0x1;
    r.coeffs[11] = 0x1;
    r.coeffs[12] = 0xffff;
    r.coeffs[13] = 0xffff;
    r.coeffs[14] = 0xffff;
    r.coeffs[15] = 0x2;
    r.coeffs[16] = 0xfffe;
    r.coeffs[17] = 0xffff;
    r.coeffs[18] = 0x2;
    r.coeffs[19] = 0xffff;
    r.coeffs[20] = 0x0;
    r.coeffs[21] = 0xffff;
    r.coeffs[22] = 0xffff;
    r.coeffs[23] = 0xffff;
    r.coeffs[24] = 0x3;
    r.coeffs[25] = 0x0;
    r.coeffs[26] = 0xfffe;
    r.coeffs[27] = 0x1;
    r.coeffs[28] = 0xffff;
    r.coeffs[29] = 0xffff;
    r.coeffs[30] = 0x0;
    r.coeffs[31] = 0xffff;
    r.coeffs[32] = 0xffff;
    r.coeffs[33] = 0x1;
    r.coeffs[34] = 0xffff;
    r.coeffs[35] = 0x1;
    r.coeffs[36] = 0xffff;
    r.coeffs[37] = 0x0;
    r.coeffs[38] = 0xfffe;
    r.coeffs[39] = 0x1;
    r.coeffs[40] = 0x2;
    r.coeffs[41] = 0x1;
    r.coeffs[42] = 0x1;
    r.coeffs[43] = 0x1;
    r.coeffs[44] = 0x1;
    r.coeffs[45] = 0xfffe;
    r.coeffs[46] = 0x0;
    r.coeffs[47] = 0xffff;
    r.coeffs[48] = 0x0;
    r.coeffs[49] = 0xffff;
    r.coeffs[50] = 0x0;
    r.coeffs[51] = 0xffff;
    r.coeffs[52] = 0xffff;
    r.coeffs[53] = 0x0;
    r.coeffs[54] = 0x0;
    r.coeffs[55] = 0x0;
    r.coeffs[56] = 0x0;
    r.coeffs[57] = 0xffff;
    r.coeffs[58] = 0xffff;
    r.coeffs[59] = 0x0;
    r.coeffs[60] = 0x0;
    r.coeffs[61] = 0xffff;
    r.coeffs[62] = 0x2;
    r.coeffs[63] = 0xfffe;
    r.coeffs[64] = 0xffff;
    r.coeffs[65] = 0xffff;
    r.coeffs[66] = 0x0;
    r.coeffs[67] = 0xfffe;
    r.coeffs[68] = 0x0;
    r.coeffs[69] = 0x1;
    r.coeffs[70] = 0x1;
    r.coeffs[71] = 0x2;
    r.coeffs[72] = 0x1;
    r.coeffs[73] = 0x0;
    r.coeffs[74] = 0x0;
    r.coeffs[75] = 0xfffe;
    r.coeffs[76] = 0x1;
    r.coeffs[77] = 0xfffe;
    r.coeffs[78] = 0x1;
    r.coeffs[79] = 0xffff;
    r.coeffs[80] = 0xfffe;
    r.coeffs[81] = 0x0;
    r.coeffs[82] = 0x1;
    r.coeffs[83] = 0x1;
    r.coeffs[84] = 0xffff;
    r.coeffs[85] = 0x1;
    r.coeffs[86] = 0x1;
    r.coeffs[87] = 0x1;
    r.coeffs[88] = 0x0;
    r.coeffs[89] = 0x1;
    r.coeffs[90] = 0xffff;
    r.coeffs[91] = 0x1;
    r.coeffs[92] = 0x2;
    r.coeffs[93] = 0x0;
    r.coeffs[94] = 0xfffe;
    r.coeffs[95] = 0x0;
    r.coeffs[96] = 0x0;
    r.coeffs[97] = 0xfffe;
    r.coeffs[98] = 0x1;
    r.coeffs[99] = 0x0;
    r.coeffs[100] = 0xffff;
    r.coeffs[101] = 0x0;
    r.coeffs[102] = 0x0;
    r.coeffs[103] = 0x2;
    r.coeffs[104] = 0x1;
    r.coeffs[105] = 0x0;
    r.coeffs[106] = 0x1;
    r.coeffs[107] = 0xffff;
    r.coeffs[108] = 0x2;
    r.coeffs[109] = 0x0;
    r.coeffs[110] = 0x1;
    r.coeffs[111] = 0x1;
    r.coeffs[112] = 0xfffd;
    r.coeffs[113] = 0x0;
    r.coeffs[114] = 0xfffe;
    r.coeffs[115] = 0xfffe;
    r.coeffs[116] = 0x1;
    r.coeffs[117] = 0x1;
    r.coeffs[118] = 0x0;
    r.coeffs[119] = 0x1;
    r.coeffs[120] = 0x2;
    r.coeffs[121] = 0xfffd;
    r.coeffs[122] = 0x1;
    r.coeffs[123] = 0xffff;
    r.coeffs[124] = 0x0;
    r.coeffs[125] = 0xffff;
    r.coeffs[126] = 0x1;
    r.coeffs[127] = 0x2;
    r.coeffs[128] = 0x1;
    r.coeffs[129] = 0x1;
    r.coeffs[130] = 0xffff;
    r.coeffs[131] = 0xffff;
    r.coeffs[132] = 0x0;
    r.coeffs[133] = 0x0;
    r.coeffs[134] = 0x1;
    r.coeffs[135] = 0x1;
    r.coeffs[136] = 0x0;
    r.coeffs[137] = 0xffff;
    r.coeffs[138] = 0x1;
    r.coeffs[139] = 0xfffe;
    r.coeffs[140] = 0xfffe;
    r.coeffs[141] = 0xfffe;
    r.coeffs[142] = 0xffff;
    r.coeffs[143] = 0x0;
    r.coeffs[144] = 0x1;
    r.coeffs[145] = 0x1;
    r.coeffs[146] = 0xffff;
    r.coeffs[147] = 0xffff;
    r.coeffs[148] = 0x0;
    r.coeffs[149] = 0x0;
    r.coeffs[150] = 0xffff;
    r.coeffs[151] = 0xffff;
    r.coeffs[152] = 0x1;
    r.coeffs[153] = 0xfffe;
    r.coeffs[154] = 0xfffe;
    r.coeffs[155] = 0x0;
    r.coeffs[156] = 0x0;
    r.coeffs[157] = 0xfffe;
    r.coeffs[158] = 0x0;
    r.coeffs[159] = 0x2;
    r.coeffs[160] = 0xffff;
    r.coeffs[161] = 0x1;
    r.coeffs[162] = 0xffff;
    r.coeffs[163] = 0x1;
    r.coeffs[164] = 0x1;
    r.coeffs[165] = 0xfffe;
    r.coeffs[166] = 0x0;
    r.coeffs[167] = 0xffff;
    r.coeffs[168] = 0x1;
    r.coeffs[169] = 0xfffe;
    r.coeffs[170] = 0x0;
    r.coeffs[171] = 0x0;
    r.coeffs[172] = 0x0;
    r.coeffs[173] = 0xffff;
    r.coeffs[174] = 0xffff;
    r.coeffs[175] = 0xffff;
    r.coeffs[176] = 0xfffe;
    r.coeffs[177] = 0x0;
    r.coeffs[178] = 0xffff;
    r.coeffs[179] = 0x1;
    r.coeffs[180] = 0x0;
    r.coeffs[181] = 0x0;
    r.coeffs[182] = 0x0;
    r.coeffs[183] = 0xfffe;
    r.coeffs[184] = 0x0;
    r.coeffs[185] = 0x1;
    r.coeffs[186] = 0xfffe;
    r.coeffs[187] = 0x2;
    r.coeffs[188] = 0x0;
    r.coeffs[189] = 0x2;
    r.coeffs[190] = 0xffff;
    r.coeffs[191] = 0x0;
    r.coeffs[192] = 0x3;
    r.coeffs[193] = 0xffff;
    r.coeffs[194] = 0xfffe;
    r.coeffs[195] = 0x1;
    r.coeffs[196] = 0x1;
    r.coeffs[197] = 0x0;
    r.coeffs[198] = 0x0;
    r.coeffs[199] = 0xfffe;
    r.coeffs[200] = 0x1;
    r.coeffs[201] = 0x0;
    r.coeffs[202] = 0x1;
    r.coeffs[203] = 0x2;
    r.coeffs[204] = 0x0;
    r.coeffs[205] = 0x0;
    r.coeffs[206] = 0xfffe;
    r.coeffs[207] = 0xfffe;
    r.coeffs[208] = 0xfffe;
    r.coeffs[209] = 0x1;
    r.coeffs[210] = 0x1;
    r.coeffs[211] = 0x0;
    r.coeffs[212] = 0x2;
    r.coeffs[213] = 0x0;
    r.coeffs[214] = 0x1;
    r.coeffs[215] = 0x1;
    r.coeffs[216] = 0x0;
    r.coeffs[217] = 0x2;
    r.coeffs[218] = 0x1;
    r.coeffs[219] = 0x0;
    r.coeffs[220] = 0x1;
    r.coeffs[221] = 0x0;
    r.coeffs[222] = 0x1;
    r.coeffs[223] = 0x1;
    r.coeffs[224] = 0x2;
    r.coeffs[225] = 0x0;
    r.coeffs[226] = 0x0;
    r.coeffs[227] = 0x2;
    r.coeffs[228] = 0x0;
    r.coeffs[229] = 0x1;
    r.coeffs[230] = 0x1;
    r.coeffs[231] = 0x0;
    r.coeffs[232] = 0xffff;
    r.coeffs[233] = 0x0;
    r.coeffs[234] = 0xffff;
    r.coeffs[235] = 0x0;
    r.coeffs[236] = 0x0;
    r.coeffs[237] = 0x0;
    r.coeffs[238] = 0x1;
    r.coeffs[239] = 0x0;
    r.coeffs[240] = 0x0;
    r.coeffs[241] = 0x0;
    r.coeffs[242] = 0x2;
    r.coeffs[243] = 0xffff;
    r.coeffs[244] = 0xffff;
    r.coeffs[245] = 0x0;
    r.coeffs[246] = 0x1;
    r.coeffs[247] = 0x3;
    r.coeffs[248] = 0xffff;
    r.coeffs[249] = 0x0;
    r.coeffs[250] = 0xffff;
    r.coeffs[251] = 0x0;
    r.coeffs[252] = 0xfffe;
    r.coeffs[253] = 0x0;
    r.coeffs[254] = 0x2;
    r.coeffs[255] = 0x0;

    golden_res[0] = 0x480;
    golden_res[1] = 0x3e5;
    golden_res[2] = 0x564;
    golden_res[3] = 0xfb12;
    golden_res[4] = 0xf980;
    golden_res[5] = 0x586;
    golden_res[6] = 0x5c1;
    golden_res[7] = 0x489;
    golden_res[8] = 0x457;
    golden_res[9] = 0xfc8d;
    golden_res[10] = 0xfbde;
    golden_res[11] = 0x53f;
    golden_res[12] = 0xfde1;
    golden_res[13] = 0xfcbf;
    golden_res[14] = 0x3f5;
    golden_res[15] = 0x666;
    golden_res[16] = 0xfbfb;
    golden_res[17] = 0x5cb;
    golden_res[18] = 0x2c1;
    golden_res[19] = 0xf9fb;
    golden_res[20] = 0xfc0d;
    golden_res[21] = 0x1fe;
    golden_res[22] = 0xfade;
    golden_res[23] = 0xfe60;
    golden_res[24] = 0x43;
    golden_res[25] = 0x621;
    golden_res[26] = 0xfab7;
    golden_res[27] = 0x133;
    golden_res[28] = 0x5f8;
    golden_res[29] = 0xfd7e;
    golden_res[30] = 0xfb23;
    golden_res[31] = 0x1bb;
    golden_res[32] = 0xfd5f;
    golden_res[33] = 0xde;
    golden_res[34] = 0x5e8;
    golden_res[35] = 0xee;
    golden_res[36] = 0xfa1d;
    golden_res[37] = 0xfb8b;
    golden_res[38] = 0x147;
    golden_res[39] = 0xfd5c;
    golden_res[40] = 0x577;
    golden_res[41] = 0xfe1f;
    golden_res[42] = 0xfac4;
    golden_res[43] = 0xfd;
    golden_res[44] = 0xfc2c;
    golden_res[45] = 0xff47;
    golden_res[46] = 0x49c;
    golden_res[47] = 0x8a;
    golden_res[48] = 0xfc71;
    golden_res[49] = 0x16a;
    golden_res[50] = 0xc5;
    golden_res[51] = 0xfa23;
    golden_res[52] = 0x475;
    golden_res[53] = 0xf9c0;
    golden_res[54] = 0xfc65;
    golden_res[55] = 0x327;
    golden_res[56] = 0x5a0;
    golden_res[57] = 0xffea;
    golden_res[58] = 0xfc4d;
    golden_res[59] = 0x37a;
    golden_res[60] = 0xff96;
    golden_res[61] = 0x7f;
    golden_res[62] = 0xff9c;
    golden_res[63] = 0x4ea;
    golden_res[64] = 0xfad7;
    golden_res[65] = 0xf9a0;
    golden_res[66] = 0x41b;
    golden_res[67] = 0x38c;
    golden_res[68] = 0x7e;
    golden_res[69] = 0xfca8;
    golden_res[70] = 0x2ad;
    golden_res[71] = 0xfb09;
    golden_res[72] = 0xe6;
    golden_res[73] = 0x4e0;
    golden_res[74] = 0xfc6c;
    golden_res[75] = 0xd5;
    golden_res[76] = 0xfefe;
    golden_res[77] = 0xfd24;
    golden_res[78] = 0x62f;
    golden_res[79] = 0xff40;
    golden_res[80] = 0xfe68;
    golden_res[81] = 0xff66;
    golden_res[82] = 0x2fb;
    golden_res[83] = 0x488;
    golden_res[84] = 0xfd59;
    golden_res[85] = 0x55b;
    golden_res[86] = 0xfcd6;
    golden_res[87] = 0xfa2d;
    golden_res[88] = 0xffaa;
    golden_res[89] = 0x11a;
    golden_res[90] = 0x347;
    golden_res[91] = 0x452;
    golden_res[92] = 0xe3;
    golden_res[93] = 0xfcf9;
    golden_res[94] = 0xfe8d;
    golden_res[95] = 0x31c;
    golden_res[96] = 0x3c1;
    golden_res[97] = 0xfcbf;
    golden_res[98] = 0xfe9b;
    golden_res[99] = 0x1be;
    golden_res[100] = 0x202;
    golden_res[101] = 0xfb07;
    golden_res[102] = 0x65e;
    golden_res[103] = 0x543;
    golden_res[104] = 0x4d0;
    golden_res[105] = 0xfe4d;
    golden_res[106] = 0x22b;
    golden_res[107] = 0x82;
    golden_res[108] = 0x38b;
    golden_res[109] = 0x5a5;
    golden_res[110] = 0xfa1e;
    golden_res[111] = 0xfb39;
    golden_res[112] = 0xfbb8;
    golden_res[113] = 0xfd94;
    golden_res[114] = 0xfa49;
    golden_res[115] = 0x59e;
    golden_res[116] = 0xff33;
    golden_res[117] = 0xfd3f;
    golden_res[118] = 0xfa44;
    golden_res[119] = 0xdb;
    golden_res[120] = 0xff;
    golden_res[121] = 0x5b3;
    golden_res[122] = 0xfab0;
    golden_res[123] = 0x5d2;
    golden_res[124] = 0x1a1;
    golden_res[125] = 0xfcc6;
    golden_res[126] = 0xfbde;
    golden_res[127] = 0x560;
    golden_res[128] = 0xfcf5;
    golden_res[129] = 0xfcc6;
    golden_res[130] = 0xfb03;
    golden_res[131] = 0xff37;
    golden_res[132] = 0xfc5d;
    golden_res[133] = 0xfddf;
    golden_res[134] = 0xffd7;
    golden_res[135] = 0xfd75;
    golden_res[136] = 0xfc06;
    golden_res[137] = 0xff65;
    golden_res[138] = 0xfda9;
    golden_res[139] = 0xfc40;
    golden_res[140] = 0xfcb4;
    golden_res[141] = 0xfb98;
    golden_res[142] = 0xfb44;
    golden_res[143] = 0xf9d5;
    golden_res[144] = 0xfe3a;
    golden_res[145] = 0x15d;
    golden_res[146] = 0x601;
    golden_res[147] = 0x22b;
    golden_res[148] = 0x66c;
    golden_res[149] = 0x1f4;
    golden_res[150] = 0xfeb8;
    golden_res[151] = 0x4a9;
    golden_res[152] = 0xfb1a;
    golden_res[153] = 0x12c;
    golden_res[154] = 0xfee6;
    golden_res[155] = 0xff99;
    golden_res[156] = 0xfdd1;
    golden_res[157] = 0x5b7;
    golden_res[158] = 0x4d;
    golden_res[159] = 0x5e2;
    golden_res[160] = 0x4d6;
    golden_res[161] = 0x4da;
    golden_res[162] = 0x5a3;
    golden_res[163] = 0xfb92;
    golden_res[164] = 0x2dd;
    golden_res[165] = 0x407;
    golden_res[166] = 0x381;
    golden_res[167] = 0xfbae;
    golden_res[168] = 0xff4e;
    golden_res[169] = 0x44f;
    golden_res[170] = 0xf9de;
    golden_res[171] = 0xfc47;
    golden_res[172] = 0xfc90;
    golden_res[173] = 0x408;
    golden_res[174] = 0x4eb;
    golden_res[175] = 0xfb92;
    golden_res[176] = 0x24b;
    golden_res[177] = 0x2ff;
    golden_res[178] = 0xfe57;
    golden_res[179] = 0x277;
    golden_res[180] = 0xff7c;
    golden_res[181] = 0xa2;
    golden_res[182] = 0xfedf;
    golden_res[183] = 0x2e;
    golden_res[184] = 0x5a0;
    golden_res[185] = 0xfbed;
    golden_res[186] = 0xfb8b;
    golden_res[187] = 0x2f9;
    golden_res[188] = 0x3af;
    golden_res[189] = 0x5cc;
    golden_res[190] = 0xfea0;
    golden_res[191] = 0x23b;
    golden_res[192] = 0x312;
    golden_res[193] = 0xffaa;
    golden_res[194] = 0x676;
    golden_res[195] = 0x34d;
    golden_res[196] = 0xfc2d;
    golden_res[197] = 0x2e4;
    golden_res[198] = 0x28b;
    golden_res[199] = 0xfce0;
    golden_res[200] = 0x5b5;
    golden_res[201] = 0xfb14;
    golden_res[202] = 0xfdb3;
    golden_res[203] = 0x136;
    golden_res[204] = 0x311;
    golden_res[205] = 0xfb76;
    golden_res[206] = 0x3d2;
    golden_res[207] = 0x14;
    golden_res[208] = 0xfad9;
    golden_res[209] = 0x4d1;
    golden_res[210] = 0x36b;
    golden_res[211] = 0x3ce;
    golden_res[212] = 0xfd6b;
    golden_res[213] = 0x14b;
    golden_res[214] = 0xfcd5;
    golden_res[215] = 0x2;
    golden_res[216] = 0xfb46;
    golden_res[217] = 0x115;
    golden_res[218] = 0xfecf;
    golden_res[219] = 0xffe3;
    golden_res[220] = 0x314;
    golden_res[221] = 0xfcf5;
    golden_res[222] = 0xfe5a;
    golden_res[223] = 0xfdfd;
    golden_res[224] = 0xfd36;
    golden_res[225] = 0xc7;
    golden_res[226] = 0xfdd0;
    golden_res[227] = 0xfda5;
    golden_res[228] = 0x618;
    golden_res[229] = 0x1db;
    golden_res[230] = 0x4af;
    golden_res[231] = 0xf9f3;
    golden_res[232] = 0xff27;
    golden_res[233] = 0x2dd;
    golden_res[234] = 0xf9ba;
    golden_res[235] = 0x1de;
    golden_res[236] = 0xfd24;
    golden_res[237] = 0xfca1;
    golden_res[238] = 0xf9d5;
    golden_res[239] = 0xfbb1;
    golden_res[240] = 0x23e;
    golden_res[241] = 0xffa3;
    golden_res[242] = 0xfa1b;
    golden_res[243] = 0xfcf4;
    golden_res[244] = 0xfe43;
    golden_res[245] = 0xf9a4;
    golden_res[246] = 0x129;
    golden_res[247] = 0xfcba;
    golden_res[248] = 0xfecb;
    golden_res[249] = 0xfc14;
    golden_res[250] = 0xfc52;
    golden_res[251] = 0xffb2;
    golden_res[252] = 0x677;
    golden_res[253] = 0x254;
    golden_res[254] = 0x149;
    golden_res[255] = 0xfa7b;

    CSR_WRITE(CSR_REG_MCYCLE, 0);
	ntt_driver(r.coeffs, dout);
	CSR_READ(CSR_REG_MCYCLE, &cycles);
    printf("with %d cycles\n", cycles); 

    for (int i = 0; i< 255; i++ ){
		if (dout[i] != golden_res[i]){
        	printf("Expected D[%d]: %04X but obtained %04X \n", i, golden_res[i], dout[i]);
		}	
	}

    printf("NTT terminated :)\n");



	return 0;

}
